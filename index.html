<!DOCTYPE html>
<html lang="en" style="height:100%">
	<head>
		<title>Silo6_heart</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				font-family: Helvetica;
				font-size: 100%;
				background-color: #000;
				color: #fff;
				margin: 0px;
				overflow: hidden;
			}
		</style>
		<link rel="stylesheet" href="styles/new_style.css">
		<script src="js/three.min.js"></script>
		<script src="js/zinc_threejs_control.js"></script>
		<script src="js/zinc_3js_renderer.js"></script>
		<script src="js/show_hide_answer.js" ></script>
		<script src="js/Add3DLabel.js" ></script>
		<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.10.4/dojo/dojo.js" data-dojo-config="async: 1, parseOnLoad: true" ></script>
		<script src="../../dojo-release-1.11.2/dojo/dojo.js" data-dojo-config="async: 1, parseOnLoad: true" ></script>
		<script src="js/LVPandECG.js" ></script>
		<script>
			var dojoConfig = {
		        async: true,
		        // This code registers the correct location of the "demo" package
		        // so we can load Dojo from the CDN whilst still being able to
		        // load local modules
		        packages: [{
		            name: "js",
		            location: location.pathname.replace(/\/[^/]+$/, "")  + "/js"
		        }]
			};
		</script>
		<script>require(["dijit/Dialog"]);</script>
	</head>
	<body style="height:100%;font-family='Helvetica'">
	<div id="main_page" class="heartpage">

		<div id="rightInformation" class="open">
			<div class="rightChartTitle" style = "width:75%;float:right;padding:10px;">
				<b>ECG</b>
			</div>
			<div id="rightECG" class="rightChart" style="width:75%;float:right;padding:10px;">
			</div>
			<div id="ECGDescription" class="rightChartDescription" style="width:75%;clear:right;float:right;padding:10px;color:#888888">
				electrical waves make the heart muscle contract
			</div>
			<div class="rightChartTitle" style="top:6%;width:75%;float:right;padding:10px;">
				<b>Pressure</b>
			</div>
			<div id="rightLVP" class="rightChart"  style="top:6%;float:right">
			</div>
			<div id="LVPDescription" class="rightChartDescription" style="top:6%;clear:right;width:75%;float:right;padding:10px;color:#888888">
				muscle contraction generates pump pressure
			</div>
			<div class="rightChartTitle" style = "top:10%;width:75%;float:right;padding:10px;clear:right">
				<b>Heart Rate</b>
			</div>
			<div id="rightRate" style = "top:10%;width:75%;clear:right;float:right;padding:10px">
				<input id="speed_slider" type="range" min="0" max="5000" value ="1000" step="1" oninput="updateSlider(this.value)" style="width:80%;"/>
			</div>
			<div class="rightChartDescription" style="top:10%;width:75%;clear:right;float:right;padding:10px;color:#888888">
				beats per minute
			</div>
			<div id="rightLogo" class="rightLogo">
				<img src="images/heart_v7/medtech_logo_quiz_qr.png" alt="logoquiz_qr" style="height:100px">
			</div>

		</div>

		<div id="leftPanelGreen" class="open">
			<div id="bottom_control" class="closed">
				<div id="home_icon" class="bottomButton open" style="left:0%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/new_image/home.png" alt="home"  onclick="realHomeClicked()" style="height:100%;width:100%">
				</div>
				<div id="home_selected_icon" class="bottomButton closed" style="left:0%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/new_image/home_selected.png" alt="home"  onclick="realHomeClicked()" style="height:100%;width:100%">
				</div>
				<div id="healthy_heart_icon" class="bottomButton closed" style="left:16.6%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/healthy_heart_icon.png" alt="home"  onclick="homeClicked()" style="height:100%;width:100%">
				</div>
				<div id="healthy_heart_selected_icon" class="bottomButton open" style="left:16.6%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/healthy_heart_selected_icon.png" alt="home" style="height:100%;width:100%">
				</div>
				<div id="attack_icon" class="bottomButton open" style="left:33.2%;;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_icon.png" alt="information" style="height:100%;width:100%" onclick="heartAttackClicked()">
				</div>
				<div id="attack_healthy_selected_icon" class="bottomButton closed" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_healthy_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="electricity_icon" class="bottomButton open" style="left:49.8%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_icon.png" alt="information" style="height:100%;width:100%" onclick="heartElectricityClicked()">
				</div>
				<div id="electricity_healthy_selected_icon" class="bottomButton closed" style="left:49.8%;position:absolute;;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_healthy_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="electricity_healthy_icon" class="bottomButton closed" style="left:49.8%;position:absolute;;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_healthy_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="electricity_fibrillation_icon" class="bottomButton closed" style="left:49.8%;position:absolute;;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_fibrillation_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<!-- <div id="electricity_fibrillation_selected_icon" class="bottomButton closed" style="left:33.2%;position:absolute;;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_fibrillation_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div> -->
				<div id="failure_icon" class="bottomButton open" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_icon.png" alt="information" style="height:100%;width:100%" onclick="heartFailureClicked()">
				</div>
				<div id="failure_healthy_selected_icon" class="bottomButton closed" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_healthy_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="about_us_icon" class="bottomButton open" style="left:83%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/about_us_icon.png" alt="information" style="height:100%;width:100%" onclick="aboutUsClicked()">
				</div>
				<div id="about_us_selected_icon" class="bottomButton closed" style="left:83%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/about_us_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
			</div>
			<div id="bottom_control_green_sub" class="closed">
				<div id="attack_sub_healthy_icon" class="bottomButton closed" style="left:16.6%position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%">
				</div>
				<div id="attack_sub_healthy_selected_icon" class="bottomButton closed" style="left:16.6%;position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%">
				</div>
				<div id="attack_sub_moderate_icon" class="bottomButton closed" style="left:33.2%;position:absolute;z-index:11;height:100%;width:16.6%" >
					<img src="images/heart_v7/attack_sub_moderate_icon.png" alt="moderate_attack" style="height:100%;width:100%"
						onclick="heartAttackStagePressed('SmallInfarct', 'MildHeartAttack', 'leftModerateAttack')">
				</div>
				<div id="attack_sub_severe_icon" class="bottomButton closed" style="left:49.8%;position:absolute;z-index:11;height:100%;width:16.6%" >
					<img src="images/heart_v7/attack_sub_severe_icon.png" alt="severe_attack" style="height:100%;width:100%"
						onclick="heartAttackStagePressed('LargeInfarct', 'SevereHeartAttack', 'leftSevereAttack')">
				</div>
				<div id="attack_line" class="bottom_control_green_graphics closed" style="bottom:0%;left:16.6%;height:10%;width:49.8%;">
				</div>
				<div id="attack_box" class="bottom_control_green_graphics closed" style="bottom:10%;left:16.6%;height:90%;width:16.6%;">
				</div>
				<div id="electricity_sub_healthy_icon" class="bottomButton closed" style="left:41.5%;position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_sub_healthy_icon.png" alt="electricity" style="height:100%;width:100%">
				</div>
				<div id="electricity_sub_healthy_selected_icon" class="bottomButton closed" style="left:41.5%;position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_sub_healthy_icon.png" alt="electricity" style="height:100%;width:100%">
				</div>
				<div id="electricity_line" class="bottom_control_green_graphics closed" style="bottom:0%;left:41.5%;height:10%;width:33.2%;">
				</div>
				<div id="electricity_box" class="bottom_control_green_graphics closed" style="bottom:10%;left:41.5%;height:90%;width:16.6%;">
				</div>
				<div id="electricity_sub_fibrillation_icon" class="bottomButton closed" style="left:58.1%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_sub_fibrillation_icon.png" alt="fibrillation" style="height:100%;width:100%"
					onclick="arrhythmiaClicked()">
				</div>
				<div id="failure_sub_healthy_icon" class="bottomButton closed" style="left:49.8%;;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%">
				</div>
				<div id="failure_sub_healthy_selected_icon" class="bottomButton closed" style="left:49.8%;;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%">
				</div>
				<div id="failure_sub_compensated_icon" class="bottomButton closed" style="left:66.4%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_compensated_icon.png" alt="vessel" style="height:100%;width:100%"
						onclick="heartFailureStagePressed('CompensatedFailure', 'CompensatedFailure', 'leftCompensatedFailure')">
				</div>
				<div id="failure_sub_decompensated_icon" class="bottomButton closed" style="left:83%;;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_decompensated_icon.png" alt="vessel" style="height:100%;width:100%"
						onclick="heartFailureStagePressed('DecompensatedFailure','DecompensatedFailure', 'leftDecompensatedFailure')">
				</div>
				<div id="failure_line" class="bottom_control_green_graphics closed" style="bottom:0%;left:49.8%;height:10%;width:50.2%;">
				</div>
				<div id="failure_box" class="bottom_control_green_graphics closed" style="bottom:10%;left:49.8%;height:90%;width:17%;">
				</div>
			</div>
			<div id="initialNormal" class="closed">
				<div class="leftTitle" >
					<b>Te Manawa</b>
				</div>
				<div class="leftDescription">
					<b>The Heart</b>
				</div>
				<div class ="leftQuestionWidget open" id="normal_1_block">
					<div class="leftQuestionPic open" id="normal_1_q">
						<b>Is this what your heart looks like?</b>
					</div>
					<div class="leftAnswer closed" id="normal_1_a">
						<p>Mostly. The pumping chambers of the heart, called the left and the
							right ventricles, are shown. There are two other chambers which sit
							on top of these called the left and right atria, and they receive
							blood from the body and push it to the ventricles for pumping.</p>
					</div>
					<div class="downArrow open" id="normal_1_d" onclick="showNormalAnswer(1, 3)">
					</div>
					<div class="upArrow closed" id="normal_1_u" onclick="showNormalQuestions(3)">
					</div>
				</div>
				<div class ="leftQuestionWidget open" id="normal_2_block">
					<div class="leftQuestionPic open" id="normal_2_q">
						<b>What is the heart’s job?</b>
					</div>
					<div class="leftAnswer closed" id="normal_2_a">
						<p>The purpose of the heart is to pump blood around the body so all the organ
						systems get the oxygen and nutrients (food) they need, as well as having their
						wastes taken away.</p>
					</div>
					<div class="downArrow open" id="normal_2_d" onclick="showNormalAnswer(2, 3)">
					</div>
					<div class="upArrow closed"  id="normal_2_u" onclick="showNormalQuestions(3)">
					</div>
				</div>
				<div class ="leftQuestionWidget open" id="normal_3_block">
					<div class="leftQuestionPic open" id="normal_3_q">
						<b>What can you observe happening to the heart?</b>
					</div>
					<div class="leftAnswer closed" id="normal_3_a">
						<p>Did you see it get smaller then larger? This contraction (shortening) of the
						heart muscle squeezes the blood inside the ventricles increasing the pressure allowing
						the blood to be pumped around the body. When the heart relaxes it fills with blood again.</p>
					</div>
					<div class="downArrow open" id="normal_3_d" onclick="showNormalAnswer(3, 3)">
					</div>
					<div class="upArrow closed" id="normal_3_u" onclick="showNormalQuestions(3)">
					</div>
				</div>
				<!-- <div class="leftQuestionWidget open" id="normal_4_block">
					<div class="leftQuestionPic open" id="normal_4_q">
						<b>How do you keep you heart healthy?</b>
					</div>
					<div class="leftAnswer closed" id="normal_4_a">
						<p>Our life style choices can affect the health of our heart:</p>
						<div id="exercise_icon" class = "medicationLifestyle" >
							<img src="images/heart_v7/exercise.png" alt="home"  onclick="showVideo('5_exercise_v2.mp4')" style="top:10%;height:83%;position:relative">
						</div>
						<div id="diet_icon" class = "medicationLifestyle" style = "top:1%;position:relative">
							<img src="images/heart_v7/diet.png" alt="home"  onclick="showVideo('6_diet_v2.mp4')" style="top:10%;height:83%;position:relative">
						</div>
						<div id="smoking_icon" class = "medicationLifestyle" style = "top:2%;position:relative" >
							<img src="images/heart_v7/smoking.png" alt="home"  onclick="showVideo('7_smoking_v2.mp4')" style="top:10%;height:83%;position:relative">
						</div>
					</div> -->
					<!-- <div class="downArrow open" id="normal_4_d" onclick="showNormalAnswer(4, 4)">
					</div>
					<div class="upArrow closed" id="normal_4_u" onclick="showNormalQuestions(4)">
					</div>
				</div> -->
			</div>
			<div id="leftHeartAttack" class="closed">
				<div class="leftTitle" >
					<b>Heart Attack</b>
				</div>
				<div class ="leftQuestionWidget open" id="attack_1_block">
					<div class="leftQuestionPic open" id="attack_1_q">
						<b> Does the heart muscle need blood?</b>
					</div>
					<div class="leftAnswer closed" id="attack_1_a">
						<p>The heart pumps blood, but it is also an organ which needs oxygen and nutrients from the blood to survive.
						The heart pumps blood to itself through vessels called the coronary
						arteries.Unhealthy lifestyle choices can cause fatty deposits to block these vessels in what is called a heart attack.</p>
						<img src="images/heart_v7/coronary_heart.png" alt="coronary" style="width:45%;">
					</div>
					<div class="downArrow open" id="attack_1_d" onclick="showAttackAnswer(1, 3)">
					</div>
					<div class="upArrow closed" id="attack_1_u" onclick="showAttackQuestions(3)">
					</div>
				</div>
				<div class="leftQuestionWidget open" id="attack_2_block">
					<div class="leftQuestionPic open" id="attack_2_q">
						<b>How do you keep you heart healthy?</b>
					</div>
					<div class="leftAnswer closed" id="attack_2_a">
						<p>Our life style choices can affect the health of our heart:</p>
						<div id="exercise_icon" class = "medicationLifestyle" >
							<img src="images/heart_v7/exercise.png" alt="home"  onclick="showVideo('5_exercise_v2.mp4')" style="top:10%;height:83%;position:relative">
						</div>
						<div id="diet_icon" class = "medicationLifestyle" style = "top:1%;position:relative">
							<img src="images/heart_v7/diet.png" alt="home"  onclick="showVideo('6_diet_v2.mp4')" style="top:10%;height:83%;position:relative">
						</div>
						<div id="smoking_icon" class = "medicationLifestyle" style = "top:2%;position:relative" >
							<img src="images/heart_v7/smoking.png" alt="home"  onclick="showVideo('7_smoking_v2.mp4')" style="top:10%;height:83%;position:relative">
						</div>
					</div>
					<div class="downArrow open" id="attack_2_d" onclick="showAttackAnswer(2, 3)">
					</div>
					<div class="upArrow closed" id="attack_2_u" onclick="showAttackQuestions(3)">
					</div>
				</div>
				<div class ="leftQuestionWidget open" id="attack_3_block">
					<div class="leftQuestionPic open" id="attack_3_q">
						<b>What could happen if a coronary artery was blocked? </b>
					</div>
					<div class="leftAnswer closed" id="attack_3_a">
						<p>If a coronary artery gets blocked then less oxygen and nutrients
							can reach the muscle. Without oxygen and nutrients, the heart muscle
							becomes damaged, which can lead to a
							<span onclick="heartAttackStagePressed('SmallInfarct', 'MildHeartAttack', 'leftModerateAttack')"
								style="color:rgb(255,255,0)"><i>moderate</i></span> or
							<span onclick="heartAttackStagePressed('LargeInfarct', 'SevereHeartAttack', 'leftSevereAttack')"
								style="color:rgb(255,50,0)"><i>severe</i></span> heart attack.</p>
							<!-- <p>Click "Moderate" below to see what this looks like. </p> -->
					</div>
					<div class="downArrow open" id="attack_3_d" onclick="showAttackAnswer(3, 3)">
					</div>
					<div class="upArrow closed" id="attack_3_u" onclick="showAttackQuestions(3)">
					</div>
				</div>

			</div>
			<div id="leftHeartElectricity" class="closed">
				<div class="leftTitle">
					<b>Heart Electricity</b>
				</div>
				<div class ="leftQuestionWidget open" id="electricity_1_block">
					<div class="leftQuestionPic open" id="electricity_1_q">
						<b>What makes the heart beat?</b>
					</div>
					<div class="leftAnswer closed" id="electricity_1_a">
						<p>If you have ever had an electric shock you may have noticed it made you tense up (your muscles contracted).
							In a healthy heart, electrical waves pass smoothly through the muscle to provide coordinated contraction (each part of the muscles contracts at just the right time) and efficient pumping.
						</p>
					</div>
					<div class="downArrow open" id="electricity_1_d" onclick="showElectricityAnswer(1, 2)">
					</div>
					<div class="upArrow closed"  id="electricity_1_u" onclick="showElectricityQuestions(2)">
					</div>
				</div>
				<div class ="leftQuestionWidget open" id="electricity_2_block">
					<div class="leftQuestionPic open" id="electricity_2_q">
						<b>What happens when the smooth electrical waves are disrupted?</b>
					</div>
					<div class="leftAnswer closed" id="electricity_2_a">
						<p>The electrical waves become random and the heart muscle just wobbles.
						</p>
						<p>Click "Fibrillation" below to see what this looks like.</p>
					</div>
					<div class="downArrow open" id="electricity_2_d" onclick="showElectricityAnswer(2, 2)">
					</div>
					<div class="upArrow closed"  id="electricity_2_u" onclick="showElectricityQuestions(2)">
					</div>
				</div>
			</div>
			<div id="leftHeartFailure" class="closed">
				<div class="leftTitle" >
					<b>Heart Failure</b>
				</div>
				<div class ="leftQuestionWidget open" id="failure_1_block">
					<div class="leftQuestionPic open" id="failure_1_q">
						<b>Can our heart wear out?</b>
					</div>
					<div class="leftAnswer closed" id="failure_1_a">
						<p>Yes. Over time the heart shape, stiffness and ability to contract can change
						due to factors such as high blood pressure. These long term changes are what we call heart failure.</p>
						<p>In early stages of heart failure, the heart can
							<span onclick="heartFailureStagePressed('CompensatedFailure', 'CompensatedFailure', 'leftCompensatedFailure')"
								style="color:rgb(255,255,0)"><i>compensate</i></span> for the
							extra load. If this goes untreated, the heart can no longer pump enough blood
							(<span onclick="heartFailureStagePressed('DecompensatedFailure','DecompensatedFailure', 'leftDecompensatedFailure')"
								style="color:rgb(255,50,0)"><i>decompensated</i></span> heart failure).</p>
					</div>
					<div class="downArrow open" id="failure_1_d" onclick="showFailureAnswer(1, 1)">
					</div>
					<div class="upArrow closed" id="failure_1_u" onclick="showFailureQuestions(1)">
					</div>
				</div>
			</div>
		</div>

		<div id="leftPanelYellow" class="closed">
			<div id="bottom_control_yellow" class="open">
				<div id="home_icon_yp" class="bottomButton open" style="left:0%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/new_image/home.png" alt="home"  onclick="realHomeClicked()" style="height:100%;width:100%">
				</div>
				<div id="healthy_heart_icon_yp" class="bottomButton open" style="left:16.6%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/healthy_heart_icon.png" alt="home"  onclick="homeClicked()" style="height:100%;width:100%">
				</div>
				<div id="attack_icon_yp" class="bottomButton open" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_icon.png" alt="information" style="height:100%;width:100%" onclick="heartAttackClicked()">
				</div>
				<div id="attack_moderate_selected_icon" class="bottomButton closed" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_moderate_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="electricity_icon_yp" class="bottomButton open" style="left:49.8%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_icon.png" alt="information" style="height:100%;width:100%" onclick="heartElectricityClicked()">
				</div>
				<div id="failure_icon_yp" class="bottomButton open" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_icon.png" alt="information" style="height:100%;width:100%" onclick="heartFailureClicked()">
				</div>
				<div id="about_us_icon_yp" class="bottomButton open" style="left:83%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/about_us_icon.png" alt="information" style="height:100%;width:100%" onclick="aboutUsClicked()">
				</div>

				<div id="failure_compensated_selected_icon" class="bottomButton closed" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_compensated_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
			</div>
			<div id="bottom_control_yellow_sub" class="open">
				<div id="attack_sub_healthy_icon_yp" class="bottomButton closed" style="left:16.6%;position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%"
						onclick="heartAttackStagePressed('NoInfarct','NoHeartAttack', 'leftHeartAttack')">
				</div>
				<div id="attack_sub_moderate_selected_icon" class="bottomButton closed" style="left:33.2%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_sub_moderate_icon.png" alt="moderate_attack" style="height:100%;width:100%"
					onclick="heartAttackStagePressed("SmallInfarct", "MildHeartAttack", "leftModerateAttack")">
				</div>
				<div id="attack_sub_severe_icon_yp" class="bottomButton closed" style="left:49.8%;position:absolute;z-index:10;height:100%;width:16.6%" >
					<img src="images/heart_v7/attack_sub_severe_icon.png" alt="severe_attack" style="height:100%;width:100%"
						onclick="heartAttackStagePressed('LargeInfarct', 'SevereHeartAttack', 'leftSevereAttack')">
				</div>
				<div id="attack_moderate_line" class="bottom_control_yellow_graphics closed" style="bottom:0%;left:16.6%;height:10%;width:49.8%;">
				</div>
				<div id="attack_moderate_box" class="bottom_control_yellow_graphics closed" style="bottom:10%;left:33.2%;height:90%;width:16.6%;">
				</div>
				<div id="failure_sub_healthy_icon_yp" class="bottomButton closed" style="left:49.8%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_healthy_icon.png" alt="healthy" style="height:100%;width:100%"
						onclick="heartFailureStagePressed('NoFailure','NoFailure', 'leftHeartFailure')">
				</div>
				<div id="failure_sub_compensated_selected_icon" class="bottomButton closed" style="left:66.4%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_compensated_icon.png" alt="compensated" style="height:100%;width:100%">
				</div>
				<div id="failure_sub_decompensated_icon_yp" class="bottomButton closed" style="left:83%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_decompensated_icon.png" alt="decompensated" style="height:100%;width:100%"
					onclick="heartFailureStagePressed('DecompensatedFailure', 'DecompensatedFailure', 'leftDecompensatedFailure')">
				</div>
				<div id="failure_compensated_line" class="bottom_control_yellow_graphics closed" style="bottom:0%;left:49.8%;height:10%;width:50.2%;">
				</div>
				<div id="failure_compensated_box" class="bottom_control_yellow_graphics closed" style="bottom:10%;left:66.4%;height:90%;width:17%;">
				</div>
			</div>
			<div id="leftModerateAttack" class="closed">
				<div class="leftTitle" >
					<b>Heart Attack</b>
				</div>
				<div class ="leftQuestionWidget open" id="moderate_1_block">
					<div class="leftQuestionPic open" id="moderate_1_q">
						<b>What changes can you observe in the heart after a heart attack?</b>
					</div>
					<div class="leftAnswer closed" id="moderate_1_a">
						<p>Did you see that the dark part can’t contract as much? (Look inside)</p>
						<p>Did you notice the pressure drop? </p>
						<p>If the heart cannot contract very well then it’s ability to pump blood is reduced.</p>
						<p>If left untreated, this can result in a
							<span onclick="heartAttackStagePressed('LargeInfarct', 'SevereHeartAttack', 'leftSevereAttack')"
								style="color:rgb(255,50,0)"><i>severe</i></span> heart attack.</p>
						<img src="images/heart_v7/coronary_block_moderate_no_vid.png" alt="moderate" style="width:45%;">

					</div>
					<div class="downArrow open" id="moderate_1_d" onclick="showModerateAnswer(1, 1)">
					</div>
					<div class="upArrow closed" id="moderate_1_u" onclick="showModerateQuestions(1)">
					</div>
				</div>
			</div>
		  <div id="leftCompensatedFailure" class="closed">
				<div class="leftTitle" >
					<b>Heart Failure</b>
				</div>
				<div class ="leftQuestionWidget open" id="compensated_1_block">
					<div class="leftQuestionPic open" style="font-size:1.5em;" id="compensated_1_q">
						<b>What changes can you observe in the heart of a person with long term high blood pressure?</b>
					</div>
					<div class="leftAnswer closed" id="compensated_1_a">
						<p>If blood pressure is always high, the heart needs to work harder
							to compensate and keep pumping blood around the body. This results
							in thicker muscle walls.</p>
						<p>If high blood pressure is left untreated, the heart muscle can weaken
							over time and enter a
							<span onclick="heartFailureStagePressed('DecompensatedFailure','DecompensatedFailure', 'leftDecompensatedFailure')"
								style="color:rgb(255,50,0)"><i>decompensated</i></span> phase of heart failure.</p>
					</div>
					<div class="downArrow open" id="compensated_1_d" onclick="showCompensatedAnswer(1, 1)">
					</div>
					<div class="upArrow closed" id="compensated_1_u" onclick="showCompensatedQuestions(1)">
					</div>
				</div>
			</div>
		</div>

		<div id="leftPanelRed" class="closed">
			<div id="bottom_control_red" class="open">
				<div id="home_icon_rp" class="bottomButton open" style="left:0%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/new_image/home.png" alt="home"  onclick="realHomeClicked()" style="height:100%;width:100%">
				</div>
				<div id="healthy_heart_icon_rp" class="bottomButton open" style="left:16.6%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/healthy_heart_icon.png" alt="home"  onclick="homeClicked()" style="height:100%;width:100%">
				</div>
				<div id="attack_icon_rp" class="bottomButton open" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_icon.png" alt="information" style="height:100%;width:100%" onclick="heartAttackClicked()">
				</div>
				<div id="attack_moderate_icon_rp" class="bottomButton closed" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_attack_moderate_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="attack_severe_selected_icon" class="bottomButton closed" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_severe_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="electricity_icon_rp" class="bottomButton open" style="left:49.8%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_icon.png" alt="information" style="height:100%;width:100%" onclick="heartElectricityClicked()">
				</div>
				<div id="electricity_fibrillation_selected_icon" class="bottomButton open" style="left:49.8%;position:absolute;;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_fibrillation_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="failure_icon_rp" class="bottomButton open" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_icon.png" alt="information" style="height:100%;width:100%" onclick="heartFailureClicked()">
				</div>
				<div id="failure_decompensated_selected_icon" class="bottomButton closed" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_decompensated_selected_icon.png" alt="information" style="height:100%;width:100%">
				</div>
				<div id="about_us_icon_rp" class="bottomButton open" style="left:83%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/about_us_icon.png" alt="information" style="height:100%;width:100%" onclick="aboutUsClicked()">
				</div>
			</div>
			<div id="bottom_control_red_sub" class="open">

				<div id="attack_sub_healthy_icon_rp" class="bottomButton closed" style="left:16.6%;position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%"
						onclick="heartAttackStagePressed('NoInfarct','NoHeartAttack', 'leftHeartAttack')">
				</div>
				<div id="attack_sub_moderate_icon_rp" class="bottomButton closed" style="left:33.2%;position:absolute;z-index:10;height:100%;width:16.6%" >
					<img src="images/heart_v7/attack_sub_moderate_icon.png" alt="moderate_attack" style="height:100%;width:100%"
						onclick="heartAttackStagePressed('SmallInfarct', 'MildHeartAttack', 'leftModerateAttack')">
				</div>
				<div id="attack_sub_severe_selected_icon" class="bottomButton closed" style="left:49.8%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_sub_severe_icon.png" alt="severe_attack" style="height:100%;width:100%">
				</div>
				<div id="attack_severe_line" class="bottom_control_red_graphics closed" style="bottom:0%;left:16.6%;height:10%;width:49.8%;"></div>
				<div id="attack_severe_box" class="bottom_control_red_graphics closed" style="bottom:10%;left:49.8%;height:90%;width:16.6%;"></div>
				<div id="electricity_sub_healthy_icon_rp" class="bottomButton closed" style="left:41.5%;position:absolute;z-index:11;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_sub_healthy_icon.png" alt="electricity" style="height:100%;width:100%" onclick=heartElectricityClicked()>
				</div>
				<div id="electricity_sub_fibrillation_selected_icon" class="bottomButton closed" style="left:58.1%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_sub_fibrillation_icon.png" alt="fibrillation" style="height:100%;width:100%">
				</div>
				<div id="fibrillation_line" class="bottom_control_red_graphics closed" style="bottom:0%;left:41.5%;height:10%;width:33.2%;"></div>
				<div id="fibrillation_box" class="bottom_control_red_graphics closed" style="bottom:10%;left:58.1%;height:90%;width:16.6%;"></div>
				<div id="failure_sub_healthy_icon_rp" class="bottomButton closed" style="left:49.8%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_healthy_icon.png" alt="vessel" style="height:100%;width:100%"
					onclick="heartFailureStagePressed('NoFailure','NoFailure', 'leftHeartFailure')">
				</div>
				<div id="failure_sub_compensated_icon_rp" class="bottomButton closed" style="left:66.4%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_compensated_icon.png" alt="vessel" style="height:100%;width:100%"
					onclick="heartFailureStagePressed('CompensatedFailure', 'CompensatedFailure', 'leftCompensatedFailure')">
				</div>
				<div id="failure_sub_decompensated_selected_icon" class="bottomButton closed" style="left:83%;position:absolute;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_sub_decompensated_icon.png" alt="vessel" style="height:100%;width:100%">
				</div>
				<div id="failure_decompensated_line" class="bottom_control_red_graphics closed" style="bottom:0%;left:49.8%;height:10%;width:50.2%;">
				</div>
				<div id="failure_decompensated_box" class="bottom_control_red_graphics closed" style="bottom:10%;left:83%;height:90%;width:17%;">
				</div>
			</div>
			<div id="leftSevereAttack" class="closed">
				<div class="leftTitle" >
					<b>Heart Attack</b>
				</div>
				<div class ="leftQuestionWidget open" id="severe_1_block">
					<div class="leftQuestionPic open" id="severe_1_q">
						<b>What would happen if the blockage in the artery got worse?</b>
					</div>
					<div class="leftAnswer closed" id="severe_1_a">
						<p>If the blockage gets worse even less blood can get through which results in even more muscle damage.
						 The movement and pumping of the heart is severely affected.</p>
						 <img src="images/heart_v7/coronary_block_severe.png" alt="severe" style="width:45%;">
					</div>
					<div class="downArrow open" id="severe_1_d" onclick="showSevereAnswer(1, 2)">
					</div>
					<div class="upArrow closed" id="severe_1_u" onclick="showSevereQuestions(2)">
					</div>
				</div>
				<div class ="leftQuestionWidget open" id="severe_2_block">
					<div class="leftQuestionPic open" id="severe_2_q">
						<b>How do doctors treat heart attacks?</b>
					</div>
					<div class="leftAnswer closed" id="severe_2_a">
						<p></p>
						<div id="statin_icon" class = "medicationLifestyle" style="top:1%;position:relative">
							<img src="images/heart_v7/statin.png" alt="home"  onclick="showVideo('3_Statins.mp4')" style="height:83%;position:relative">
						</div>
						<div id="aspirin_icon" class = "medicationLifestyle" style="top:2%;position:relative">
							<img src="images/heart_v7/aspirin.png" alt="home"  onclick="showVideo('4_aspirin.mp4')" style="top:10%;height:83%;position:relative">
						</div>
						<p>These therapies must be combined with improving lifestyle choices (more exercise, better diet, and avoid smoking).</p>
					</div>
					<div class="downArrow open" id="severe_2_d" onclick="showSevereAnswer(2, 2)">
					</div>
					<div class="upArrow closed" id="severe_2_u" onclick="showSevereQuestions(2)">
					</div>
				</div>
			</div>
			<div id="leftHeartArrhythmia" class="closed">
				<div class="leftTitle" >
					<b>Fibrillation</b>
				</div>
				<div class ="leftQuestionWidget open" id="arrhythmia_1_block">
					<div class="leftQuestionPic open" id="arrhythmia_1_q">
						<b>What happens during heart fibrillation?</b>
					</div>
					<div class="leftAnswer closed" id="arrhythmia_1_a">
						<p>The electrical waves in the heart become chaotic, which means that the heart does not contract smoothly and
						cannot generate enough pressure to pump the blood. </p>
					</div>
					<div class="downArrow open" id="arrhythmia_1_d" onclick="showArrhythmiaAnswer(1, 2)">
					</div>
					<div class="upArrow closed" id="arrhythmia_1_u" onclick="showArrhythmiaQuestions(2)">
					</div>
				</div>
				<div class ="leftQuestionWidget open" id="arrhythmia_2_block">
					<div class="leftQuestionPic open" id="arrhythmia_2_q">
						<b>What can we do to fix a fibrillating heart?</b>
					</div>
					<div class="leftAnswer closed" id="arrhythmia_2_a">
						<p>CLEAR! We need to apply a large electrical shock to reset the electrical waves. We need an Automated External Defibrillator (AED).
						</p>
						<p> Click on the AED below to save this heart!</p>
						<img src="images/heart_v7/defibrillation.png" alt="aed" style="left:20%" onclick="AEDClicked()">
					</div>
					<div class="downArrow open" id="arrhythmia_2_d" onclick="showArrhythmiaAnswer(2, 2)">
					</div>
					<div class="upArrow closed" id="arrhythmia_2_u" onclick="showArrhythmiaQuestions(2)">
					</div>
				</div>
			</div>
			<div id="leftDecompensatedFailure" class="closed">
				<div class="leftTitle" >
					<b>Heart Failure</b>
				</div>
				<div class ="leftQuestionWidget open" id="decompensated_1_block">
					<div class="leftQuestionPic open" id="decompensated_1_q">
						<b>What happens if high blood pressure is left untreated?</b>
					</div>
					<div class="leftAnswer closed" id="decompensated_1_a">
						<p>The heart is larger and the walls are thinner and the heart
							fails to pump enough blood around the body.</p>
					</div>
					<div class="downArrow open" id="decompensated_1_d" onclick="showDecompensatedAnswer(1, 1)">
					</div>
					<div class="upArrow closed" id="decompensated_1_u" onclick="showDecompensatedQuestions(1)">
					</div>
				</div>
			</div>
		</div>

		<div id="leftPanelPurple" class="closed">
			<div id="bottom_control_purple" class="open">
				<div id="home_icon_pp" class="bottomButton open" style="left:0%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/new_image/home.png" alt="home"  onclick="realHomeClicked()" style="height:100%;width:100%">
				</div>
				<div id="healthy_heart_icon_pp" class="bottomButton open" style="left:16.6%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/healthy_heart_icon.png" alt="home"  onclick="homeClicked()" style="height:100%;width:100%">
				</div>
				<div id="attack_icon_pp" class="bottomButton open" style="left:33.2%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/attack_icon.png" alt="information" style="height:100%;width:100%" onclick="heartAttackClicked()">
				</div>
				<div id="electricity_icon_pp" class="bottomButton open" style="left:49.8%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/electricity_icon.png" alt="information" style="height:100%;width:100%" onclick="heartElectricityClicked()">
				</div>
				<div id="failure_icon_pp" class="bottomButton open" style="left:66.4%;position:absolute;bottom:0%;z-index:10;height:100%;width:16.6%">
					<img src="images/heart_v7/failure_icon.png" alt="information" style="height:100%;width:100%" onclick="heartFailureClicked()">
				</div>
				<div id="about_us_selected_icon" class="bottomButton open" style="left:83%;position:absolute;bottom:0%;z-index:10;height:100%;width:17%">
					<img src="images/heart_v7/about_us_selected_icon.png" alt="information" style="height:100%;width:100%" onclick="aboutUsClicked()">
				</div>
			</div>
			<div id="aboutUs" class="open">
				<div class="leftTitle">
					<b>About Us</b>
				</div>
				<div id="our_research_icon" style="top:20%;" class="aboutUsButtons closed" onclick="ourResearchClicked()">
					Our Research
				</div>
				<div id="our_research_selected_icon"
					style="top:20%;background-color:rgba(150,30,150,0.4);color:rgb(255,255,255)"
					class="aboutUsButtons open" onclick="ourResearchClicked()">
					Our Research
				</div>
				<div id="our_team_icon" style="top:40%;" class="aboutUsButtons open" onclick="ourTeamClicked()">
					Our Team
				</div>
				<div id="our_team_selected_icon"
					style="top:40%;background-color:rgba(150,30,150,0.4);color:rgb(255,255,255)"
					class="aboutUsButtons closed">
					Our Team
				</div>
				<div id="feedback_icon" style="top:60%;" class="aboutUsButtons open" onclick="feedbackClicked()">
					Feedback
				</div>
				<div id="feedback_selected_icon"
					style="top:60%;background-color:rgba(150,30,150,0.4);color:rgb(255,255,255)"
					class="aboutUsButtons closed">
					Feedback
				</div>
			</div>
		</div>
		<div id="aboutUsInfoPanel" class="closed">
			<div id="ourResearch" class="closed">
				<img src="images/heart_v7/abi_banner.png" style="bottom:2%;left:2%;height:40%;position:absolute;" alt="abi_banner">
			</div>
			<div id="ourTeam" class="closed">
				<div id="ourMission" class="mission open" style="left:10%;">
					<span style="color:white;font-size:2em;"><b>Our Mission</b></span>
					<p>Cross-disciplinary research in image-driven personalized mechanical
					analysis of the heart.</p>
				</div>
				<div id="ourVision" class="mission open" style="left:55%;">
					<span style="color:white;font-size:2em;"><b>Our Vision</b></span>
					<p>Computational modelling will aid clinical diagnosis and management
					of cardiac diseases.</p>
				</div>
				<div id="headshots" style="position:absolute;top:30%;left:12%;height:40%">
					<img src="images/heart_v7/headshots.png" style="height:100%" alt="headshots">
				</div>
				<div id="funding" style="position:absolute;left:16%;top:73%;width:65%">
					<img src="images/heart_v7/funding.png" style="width:100%" alt="funding">
				</div>
			</div>
			<div id="feedback" class="closed">
				<div id="funding" style="position:absolute;left:16%;top:10%;width:60%">
					<img src="images/heart_v7/feedback.jpg" style="width:100%" alt="feedback">
				</div>
			</div>
		</div>

		<div id="more" class="closed" onclick="moreClicked()">
			<img src="images/more.png" alt="more" style="height:40%;">
		</div>
		<div id="bottom_right_control" class="open">
			<div id="halfHeart" class="halfHeart open" style="right:0%;bottom:0%;position:absolute;height:100%;z-index:12">
				<img src="images/new_image/half_heart.png" alt="halfHeart" style="height:100%" onclick="halfHeartPressed()">
			</div>
			<div id="fullHeart" class="halfHeart closed" style="right:0%;bottom:0%;position:absolute;height:100%;z-index:12">
				<img src="images/new_image/full_heart.png" alt="fullHeart" style="height:100% " onclick="halfHeartPressed()">
			</div>
		</div>
		<div id="gestures">
			<div id="gestures_icon">
				<img src="images/heart_v7/gestures_icon.png" alt="gestures_icon" style="width:100%">
			</div>
		</div>
		<div id="myRenderer" class="open">
		</div>
		<!--<div data-dojo-type="dijit/Dialog" data-dojo-id="videoDialog" id="videoDialog" onHide="pauseVideo()" style="background-color:#666;width:980px;height:760px">-->
    		<!--&lt;!&ndash;<table class="dijitDialogPaneContentArea">&ndash;&gt;-->
				<!--&lt;!&ndash;&lt;!&ndash;<video width="960" height="720" align="center" style = "left:10px;top:6px;position:relative" id="heart_video" controls>&ndash;&gt;&ndash;&gt;-->
  					<!--&lt;!&ndash;&lt;!&ndash;<source src="videos/1_healthy_heart.mp4" type="video/mp4">&ndash;&gt;&ndash;&gt;-->
					<!--&lt;!&ndash;&lt;!&ndash;Your browser does not support the video tag.&ndash;&gt;&ndash;&gt;-->
				<!--&lt;!&ndash;&lt;!&ndash;</video>&ndash;&gt;&ndash;&gt;-->
    		<!--&lt;!&ndash;</table>&ndash;&gt;-->
		<!--</div>-->
	</div>

	<script>
		var modelURLsArray = [];
		setUpArrays();
		var container = document.getElementById("myRenderer")
		var zincRenderer = new Zinc.Renderer(container, window);
		Zinc.defaultMaterialColor = 0xFFFF9C;
		zincRenderer.initialiseVisualisation();
		zincRenderer.getThreeJSRenderer().setClearColor( 0x000000, 1);
		var halfHeartFlag = false;
		var leftPanelGreenIDs = ["initialNormal", "leftHeartElectricity",  "leftHeartAttack",
			 "leftHeartFailure"];
		var leftPanelYellowIDs = ["leftModerateAttack","leftCompensatedFailure"];
		var leftPanelRedIDs = ["leftHeartArrhythmia","leftSevereAttack", "leftDecompensatedFailure"];
		var leftPanelPurpleIDs = ["ourResearch","ourTeam","feedback"];
		var idleTime = 0;
		var idleTimeLimit = 300000;
		var oldTime = new Date();
		var iconIds = ["electricity_icon","electricity_icon_yp", "electricity_icon_rp",
		  "electricity_healthy_icon","electricity_healthy_selected_icon",
		  "electricity_fibrillation_icon","electricity_fibrillation_selected_icon",
			"attack_icon", "attack_icon_yp", "attack_icon_rp",
			"attack_healthy_selected_icon","attack_moderate_selected_icon","attack_severe_selected_icon",
			"failure_icon", "failure_icon_yp","failure_icon_rp",
			"failure_healthy_selected_icon","failure_compensated_selected_icon","failure_decompensated_selected_icon"];
		var subIconIds = ["electricity_sub_healthy_icon",
			"electricity_sub_healthy_selected_icon","electricity_sub_healthy_icon_rp",
			"electricity_sub_fibrillation_icon","electricity_sub_fibrillation_selected_icon",
			"attack_sub_healthy_icon","attack_sub_healthy_icon_yp","attack_sub_healthy_icon_rp",
			"attack_sub_healthy_selected_icon",
			"attack_sub_moderate_icon","attack_sub_moderate_icon_rp",
			"attack_sub_moderate_selected_icon",
			"attack_sub_severe_icon","attack_sub_severe_icon_yp",
			"attack_sub_severe_selected_icon",
			"failure_sub_healthy_icon","failure_sub_healthy_icon_yp","failure_sub_healthy_icon_rp",
			"failure_sub_healthy_selected_icon",
			"failure_sub_compensated_icon","failure_sub_compensated_icon_rp",
			"failure_sub_compensated_selected_icon",
			"failure_sub_decompensated_icon","failure_sub_decompensated_icon_yp",
			"failure_sub_decompensated_selected_icon"];
		var subGraphicIds = ["electricity_line","electricity_box",
			"fibrillation_line","fibrillation_box","attack_line","attack_box",
			"failure_line","failure_box", "attack_moderate_line", "attack_moderate_box",
			"failure_compensated_line","failure_compensated_box","attack_severe_line",
			"attack_severe_box","failure_decompensated_line","failure_decompensated_box"];
		var modelToSceneArray = [];
		var previousCamera = undefined;

		function loadFirstPage() {
			leftPanelGreenTrigger("initialNormal");
			document.getElementById("rightInformation").className = "open";
			document.getElementById("bottom_control").className = "open";
			document.getElementById("halfHeart").classList.remove("closed");
			document.getElementById("halfHeart").classList.add("open");
			document.getElementById("fullHeart").classList.remove("open");
			document.getElementById("fullHeart").classList.add("closed");
			document.getElementById("healthy_heart_icon").className = "closed";
			document.getElementById("healthy_heart_selected_icon").className = "open";
			// document.getElementById("rightPanel").className = "closed";
			// document.getElementById("rightPanelBottom").className = "closed";
			//showFibres(false);
			//displayFibresIcon(true);
			showECGAndLVP("Normal", 0.0);
		}

		function homeClicked() {
			if (document.getElementById("initialNormal").classList.contains("closed")) {
				document.getElementById("healthy_heart_icon").className = "closed";
				document.getElementById("healthy_heart_selected_icon").className = "open";
				showIcons("electricity_icon", "attack_icon", "failure_icon");
				leftPanelGreenTrigger("initialNormal");
				document.getElementById("bottom_control_green_sub").className = "closed";
				document.getElementById("bottom_control_yellow_sub").className = "closed";
				document.getElementById("bottom_control_red_sub").className = "closed";
				previousCamera = undefined;
				resetAllModelsView();
				halfHeartFlag = false;
				document.getElementById("halfHeart").classList.remove("closed");
				document.getElementById("halfHeart").classList.add("open");
				document.getElementById("fullHeart").classList.remove("open");
				document.getElementById("fullHeart").classList.add("closed");
				loadModel("NoInfarct", 1.0);
				//showFibres(false);
				//displayFibresIcon(true);
				showECGAndLVP("Normal", 0.0);
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed"
			}
		}

        function realHomeClicked() {
			window.location.assign("../index.html");
		}

		function leftPanelGreenTrigger(elementIdToDisplay) {
			document.getElementById("leftPanelGreen").className="open";
			document.getElementById("leftPanelPurple").className="closed";
			for(var i = 0; i < leftPanelGreenIDs.length; i++){
    			var id = leftPanelGreenIDs[i];
				document.getElementById(id).classList.remove("open");
				document.getElementById(id).classList.add("closed");
			}
			document.getElementById("leftPanelYellow").className="closed";
			document.getElementById("leftPanelRed").className="closed";
			document.getElementById("aboutUsInfoPanel").className="closed";
			document.getElementById("rightInformation").className="open";
			document.getElementById("bottom_right_control").className="open";
			document.getElementById("gestures_icon").className="open";
			if (elementIdToDisplay) {
				document.getElementById(elementIdToDisplay).className = "open";
			}
			// document.getElementById("rightPanel").className = "closed";
			// document.getElementById("rightPanelBottom").className = "closed";
		}

		function leftPanelYellowTrigger(elementIdToDisplay) {
			document.getElementById("leftPanelRed").className="closed";
			document.getElementById("leftPanelGreen").className="closed";
			document.getElementById("leftPanelPurple").className="closed";
			document.getElementById("aboutUsInfoPanel").className="closed";
			document.getElementById("leftPanelYellow").className="open";
			document.getElementById("rightInformation").className="open";
			document.getElementById("bottom_right_control").className="open";
			document.getElementById("gestures_icon").className="open";
			for(var i = 0; i < leftPanelYellowIDs.length; i++){
    		var id = leftPanelYellowIDs[i];
				document.getElementById(id).classList.remove("open");
				document.getElementById(id).classList.add("closed");
			}
			if (elementIdToDisplay) {
				document.getElementById(elementIdToDisplay).className = "open";
			}
			// document.getElementById("rightPanel").className = "closed";
			// document.getElementById("rightPanelBottom").className = "closed";
		}

		function leftPanelRedTrigger(elementIdToDisplay) {
			document.getElementById("leftPanelGreen").className="closed";
			document.getElementById("leftPanelYellow").className="closed";
			document.getElementById("leftPanelPurple").className="closed";
			document.getElementById("aboutUsInfoPanel").className="closed";
			document.getElementById("rightInformation").className="open";
			document.getElementById("bottom_right_control").className="open";
			document.getElementById("gestures_icon").className="open";
			document.getElementById("leftPanelRed").className="open";
			for(var i = 0; i < leftPanelRedIDs.length; i++){
    			var id = leftPanelRedIDs[i];
				document.getElementById(id).classList.remove("open");
				document.getElementById(id).classList.add("closed");
			}
			if (elementIdToDisplay) {
				document.getElementById(elementIdToDisplay).className = "open";
			}
			// document.getElementById("rightPanel").className = "closed";
			// document.getElementById("rightPanelBottom").className = "closed";
		}

		function leftPanelPurpleTrigger(elementIdToDisplay) {
			document.getElementById("leftPanelGreen").className="closed";
			document.getElementById("leftPanelYellow").className="closed";
			document.getElementById("leftPanelRed").className="closed";
			document.getElementById("gestures_icon").className="closed";
			document.getElementById("rightInformation").className="closed";
			document.getElementById("bottom_right_control").className="closed";
			document.getElementById("initialNormal").className="closed";
			document.getElementById("leftPanelPurple").className="open";
			document.getElementById("aboutUsInfoPanel").className="open";
			var defaultScene = zincRenderer.getSceneByName("default");
			zincRenderer.setCurrentScene(defaultScene);
			for(var i = 0; i < leftPanelPurpleIDs.length; i++){
    		var id = leftPanelPurpleIDs[i];
				document.getElementById(id).classList.remove("open");
				document.getElementById(id).classList.add("closed");
			}
			if (elementIdToDisplay) {
				document.getElementById(elementIdToDisplay).className = "open";
			}
		}

		function showIcons(showIcon1, showIcon2, showIcon3) {
			for(var i = 0; i < iconIds.length; i++){
	    		var id = iconIds[i];
	    		if ((id !=   showIcon1) && (id != showIcon2) && (id != showIcon3)) {
						document.getElementById(id).classList.remove("open");
						document.getElementById(id).classList.add("closed");
				}
			}
			if (document.getElementById(showIcon1).classList.contains("closed")) {
				document.getElementById(showIcon1).classList.remove("closed");
				document.getElementById(showIcon1).classList.add("open");
			}
			if (document.getElementById(showIcon2).classList.contains("closed")) {
				document.getElementById(showIcon2).classList.remove("closed");
				document.getElementById(showIcon2).classList.add("open");
			}
			if (document.getElementById(showIcon3).classList.contains("closed")) {

				document.getElementById(showIcon3).classList.remove("closed");
				document.getElementById(showIcon3).classList.add("open");
			}
		}

		function showSubIcons(showSubIcon1, showSubIcon2, showSubIcon3) {
			for(var i = 0; i < subIconIds.length; i++){
	    	var id = subIconIds[i];
	    	if ((id != showSubIcon1) && (id != showSubIcon2) && (id != showSubIcon3)) {
					document.getElementById(id).classList.remove("open");
					document.getElementById(id).classList.add("closed");
				}
			}
			if (document.getElementById(showSubIcon1).classList.contains("closed")) {
				document.getElementById(showSubIcon1).classList.remove("closed");
				document.getElementById(showSubIcon1).classList.add("open");
			}
			if (document.getElementById(showSubIcon2).classList.contains("closed")) {
				document.getElementById(showSubIcon2).classList.remove("closed");
				document.getElementById(showSubIcon2).classList.add("open");
			}
			if (document.getElementById(showSubIcon3).classList.contains("closed")) {
				document.getElementById(showSubIcon3).classList.remove("closed");
				document.getElementById(showSubIcon3).classList.add("open");
			}
		}

		function showSubGraphics(showGraphicsLine, showGraphicsBox){
			for(var i = 0; i < subGraphicIds.length; i++){
				var id = subGraphicIds[i];
				if ((id != showGraphicsLine) && (id != showGraphicsBox)) {
					document.getElementById(id).classList.remove("open");
					document.getElementById(id).classList.add("closed");
				}
			}
			if (document.getElementById(showGraphicsLine).classList.contains("closed")) {
				document.getElementById(showGraphicsLine).classList.remove("closed");
				document.getElementById(showGraphicsLine).classList.add("open");
			}
			if (document.getElementById(showGraphicsBox).classList.contains("closed")) {
				document.getElementById(showGraphicsBox).classList.remove("closed");
				document.getElementById(showGraphicsBox).classList.add("open");
			}
		}

		function heartElectricityClicked() {
			leftPanelGreenTrigger("leftHeartElectricity");
			document.getElementById("bottom_control_green_sub").className = "open";
			showSubIcons("electricity_sub_healthy_selected_icon","electricity_sub_fibrillation_icon","electricity_sub_fibrillation_icon");
			showSubGraphics("electricity_line","electricity_box");
			showIcons("electricity_healthy_selected_icon", "attack_icon", "failure_icon");
			showElectricityQuestions(2)
			document.getElementById("healthy_heart_icon").className = "bottomButton open";
			document.getElementById("healthy_heart_selected_icon").className = "closed";
			previousCamera = undefined;
			loadModel("NormalElectricity", 1.0);
			showECGAndLVP("Normal", 0.0);
		}

		function arrhythmiaClicked() {
			//document.getElementById("leftPanelRed").className = "open";
			//document.getElementById("bottom_control_red_sub").className = "open";
			leftPanelRedTrigger("leftHeartArrhythmia");
			document.getElementById("bottom_control_red_sub").className="open";
			showSubIcons( "electricity_sub_healthy_icon_rp","electricity_sub_fibrillation_selected_icon","electricity_sub_fibrillation_selected_icon")
			showIcons("electricity_fibrillation_selected_icon","attack_icon_rp","failure_icon_rp");
			showSubGraphics("fibrillation_line","fibrillation_box")
			showArrhythmiaQuestions(2)
			loadModel("ArrythmiaElectricity", 0.25);
			showECGAndLVP("Arrhythmia", 0.0);
		}

		function AEDClicked() {
			document.getElementById("bottom_control_green_sub").className = "open";
			showSubIcons("electricity_sub_healthy_selected_icon","electricity_sub_fibrillation_icon","electricity_sub_fibrillation_icon")
			showIcons("electricity_healthy_selected_icon", "attack_icon", "failure_icon");
			showSubGraphics("electricity_line","electricity_box");
			showElectricityQuestions(2)
			leftPanelGreenTrigger("leftHeartElectricity");
			document.getElementById("healthy_heart_icon").className = "bottomButton open";
			document.getElementById("healthy_heart_selected_icon").className = "closed";
			previousCamera = undefined;
			loadModel("NormalElectricity", 1.0);
			showECGAndLVP("Normal", 0.0);
		}

		function heartAttackClicked() {
			showIcons("electricity_icon", "attack_healthy_selected_icon", "failure_icon");
			showSubGraphics("attack_line","attack_box");
			document.getElementById("bottom_control_green_sub").className = "open";
			showSubIcons("attack_sub_healthy_selected_icon","attack_sub_moderate_icon","attack_sub_severe_icon")
			showAttackQuestions(3)
			//displayFibresIcon(false);
			document.getElementById("healthy_heart_icon").className = "bottomButton open";
			document.getElementById("healthy_heart_selected_icon").className = "closed";
			leftPanelGreenTrigger("leftHeartAttack");
			previousCamera = undefined;
			heartAttackStagePressed("NoInfarct","NoHeartAttack", "leftHeartAttack");
		}

		var heartAttackStagePressed = function(StageName, pressedElement, descriptionId) {
			loadModel(StageName, 1.0);
			previousCamera = zincRenderer.getCurrentScene().camera;
			showECGAndLVP(StageName, 0.0);
			document.getElementById("leftHeartAttack").classList.remove("open");
			document.getElementById("leftHeartAttack").classList.add("closed");
			document.getElementById("leftModerateAttack").classList.remove("open");
			document.getElementById("leftModerateAttack").classList.add("closed");
			document.getElementById("leftSevereAttack").classList.remove("open");
			document.getElementById("leftSevereAttack").classList.add("closed");
			// document.getElementById("rightPanel").className = "closed";
			// document.getElementById("rightPanelBottom").className = "closed";
			document.getElementById(descriptionId).classList.remove("closed");
			document.getElementById(descriptionId).classList.add("open");
			if (descriptionId== "leftHeartAttack"){
				document.getElementById('bottom_control_green_sub').className='open'
				showIcons("electricity_icon","attack_healthy_selected_icon","failure_icon")
				showSubIcons("attack_sub_healthy_selected_icon","attack_sub_moderate_icon",
					"attack_sub_severe_icon")
				showSubGraphics("attack_line","attack_box")
				showAttackQuestions(3)
				leftPanelGreenTrigger("leftHeartAttack")
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed";
			}
			if (descriptionId== "leftModerateAttack"){
				document.getElementById('bottom_control_yellow_sub').className='open'
				showIcons("electricity_icon_yp","attack_moderate_selected_icon","failure_icon_yp")
				showSubIcons("attack_sub_healthy_icon_yp","attack_sub_moderate_selected_icon",
					"attack_sub_severe_icon_yp")
				showSubGraphics("attack_moderate_line","attack_moderate_box")
				showModerateQuestions(1)
				leftPanelYellowTrigger("leftModerateAttack")
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed";
			}
			if (descriptionId== "leftSevereAttack"){
				document.getElementById('bottom_control_red_sub').className='open'
				showIcons("electricity_icon_rp","attack_severe_selected_icon","failure_icon_rp")
				showSubIcons("attack_sub_healthy_icon_rp","attack_sub_moderate_icon_rp",
					"attack_sub_severe_selected_icon")
				showSubGraphics("attack_severe_line","attack_severe_box")
				showSevereQuestions(2)
				leftPanelRedTrigger("leftSevereAttack")
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed";
			}
		}

		function heartFailureClicked() {
			showIcons("electricity_icon", "attack_icon", "failure_healthy_selected_icon");
			showSubGraphics("failure_line","failure_box");
			document.getElementById("bottom_control_green_sub").className = "open";
			showSubIcons("failure_sub_healthy_selected_icon","failure_sub_compensated_icon","failure_sub_decompensated_icon")
			showFailureQuestions(1)
			//displayFibresIcon(false);
			document.getElementById("healthy_heart_icon").className = "bottomButton open";
			document.getElementById("healthy_heart_selected_icon").className = "closed";
			leftPanelGreenTrigger("leftHeartFailure");
			previousCamera = undefined;
			heartFailureStagePressed("NoFailure", "NoFailure", "leftHeartFailure");
		}

		var heartFailureStagePressed = function(StageName, pressedElement, descriptionId){
			loadModel(StageName, 1.0);
			previousCamera = zincRenderer.getCurrentScene().camera;
			showECGAndLVP(StageName, 0.0);
			document.getElementById("leftHeartFailure").classList.remove("open");
			document.getElementById("leftHeartFailure").classList.add("closed");
			document.getElementById("leftCompensatedFailure").classList.remove("open");
			document.getElementById("leftCompensatedFailure").classList.add("closed");
			document.getElementById("leftDecompensatedFailure").classList.remove("open");
			document.getElementById("leftDecompensatedFailure").classList.add("closed");
			document.getElementById(descriptionId).classList.remove("closed");
			document.getElementById(descriptionId).classList.add("open");
			if (descriptionId== "leftHeartFailure"){
				document.getElementById('bottom_control_green_sub').className='open'
				showIcons("electricity_icon","attack_icon","failure_healthy_selected_icon")
				showSubIcons("failure_sub_healthy_selected_icon","failure_sub_compensated_icon",
					"failure_sub_decompensated_icon")
				showSubGraphics("failure_line","failure_box")
				showFailureQuestions(1)
				leftPanelGreenTrigger("leftHeartFailure")
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed";
			}
			if (descriptionId== "leftCompensatedFailure"){
				document.getElementById("bottom_control_yellow_sub").className="open";
				showIcons("electricity_icon_yp","attack_icon_yp","failure_compensated_selected_icon")
				showSubIcons("failure_sub_healthy_icon_yp","failure_sub_compensated_selected_icon",
					"failure_sub_decompensated_icon_yp")
				showSubGraphics("failure_compensated_line","failure_compensated_box")
				showCompensatedQuestions(1)
				leftPanelYellowTrigger("leftCompensatedFailure")
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed";
			}
			if (descriptionId== "leftDecompensatedFailure"){
				document.getElementById('bottom_control_red_sub').className='open'
				showIcons("electricity_icon_rp","attack_icon_rp","failure_decompensated_selected_icon")
				showSubIcons("failure_sub_healthy_icon_rp","failure_sub_compensated_icon_rp",
					"failure_sub_decompensated_selected_icon")
				showSubGraphics("failure_decompensated_line","failure_decompensated_box")
				showDecompensatedQuestions(1)
				leftPanelRedTrigger("leftDecompensatedFailure")
				// document.getElementById("rightPanel").className = "closed";
				// document.getElementById("rightPanelBottom").className = "closed";
			}
		}

		function aboutUsClicked(){
			leftPanelPurpleTrigger("ourResearch");
			ourResearchClicked();
			document.getElementById("healthy_heart_icon").className = "bottomButton open";
			document.getElementById("healthy_heart_selected_icon").className = "closed";
		}

		function ourResearchClicked(){
			document.getElementById("our_research_icon").className="aboutUsButtons closed";
			document.getElementById("our_research_selected_icon").className="aboutUsButtons open";
			document.getElementById("our_team_icon").className="aboutUsButtons open";
			document.getElementById("our_team_selected_icon").className="aboutUsButtons closed";
			document.getElementById("feedback_icon").className="aboutUsButtons open";
			document.getElementById("feedback_selected_icon").className="aboutUsButtons closed";
			leftPanelPurpleTrigger("ourResearch");
		}

		function ourTeamClicked(){
			document.getElementById("our_research_icon").className="aboutUsButtons open";
			document.getElementById("our_research_selected_icon").className="aboutUsButtons closed";
			document.getElementById("our_team_icon").className="aboutUsButtons closed";
			document.getElementById("our_team_selected_icon").className="aboutUsButtons open";
			document.getElementById("feedback_icon").className="aboutUsButtons open";
			document.getElementById("feedback_selected_icon").className="aboutUsButtons closed";
			leftPanelPurpleTrigger("ourTeam")
		}

		function feedbackClicked(){
			document.getElementById("our_research_icon").className="aboutUsButtons open";
			document.getElementById("our_research_selected_icon").className="aboutUsButtons closed";
			document.getElementById("our_team_icon").className="aboutUsButtons open";
			document.getElementById("our_team_selected_icon").className="aboutUsButtons closed";
			document.getElementById("feedback_icon").className="aboutUsButtons closed";
			document.getElementById("feedback_selected_icon").className="aboutUsButtons open";
			leftPanelPurpleTrigger("feedback")
		}

		window.addEventListener("mousedown", function() {idleTime = 0;oldTime = new Date(); }, false);
		window.addEventListener("mousemove", function() {idleTime = 0;oldTime = new Date();}, false);
		window.addEventListener("mouseup", function(){idleTime = 0;oldTime = new Date();}, false);
		window.addEventListener("touchstart", function() {idleTime = 0;oldTime = new Date(); }, false);
		window.addEventListener("touchend", function() {idleTime = 0;oldTime = new Date();}, false);
		window.addEventListener("touchcancel", function(){idleTime = 0;oldTime = new Date();}, false);
		window.addEventListener("touchmove", function(){idleTime = 0;oldTime = new Date();}, false);

		loadModel("NoInfarct", 1.0);
		zincRenderer.animate();
		document.getElementById("speed_slider").value = 1000;

		var updateIndicatorsAndTimer = function() {
			var newTime = new Date();
			idleTime = idleTime + newTime.getTime() - oldTime.getTime();
			oldTime = newTime;
			if (idleTime > idleTimeLimit) {
				idleTimerReached();
			}

			var normaliseTime = zincRenderer.getCurrentTime() / 3000.0;
			updateIndicator(normaliseTime);
		}

		zincRenderer.addPreRenderCallbackFunction(updateIndicatorsAndTimer);

		function displayHalfHeartIcon() {
			if (halfHeartFlag) {
				document.getElementById("halfHeart").classList.remove("open");
				document.getElementById("halfHeart").classList.add("closed");
				document.getElementById("fullHeart").classList.remove("closed");
				document.getElementById("fullHeart").classList.add("open");
			} else {
				document.getElementById("halfHeart").classList.remove("closed");
				document.getElementById("halfHeart").classList.add("open");
				document.getElementById("fullHeart").classList.remove("open");
				document.getElementById("fullHeart").classList.add("closed");
			}
		}

		function displayFibresIcon(flag) {
			if (flag) {
				document.getElementById("showFibres").classList.remove("closed");
				document.getElementById("showFibres").classList.add("open");
				document.getElementById("hideFibres").classList.remove("open");
				document.getElementById("hideFibres").classList.add("closed");
			} else {
				document.getElementById("showFibres").classList.remove("open");
				document.getElementById("showFibres").classList.add("closed");
				document.getElementById("hideFibres").classList.remove("open");
				document.getElementById("hideFibres").classList.add("closed");
			}
		}

		function geometryShowFibres(flag, currentTime) {
			return function(zincGeometry) {
				if (zincGeometry.groupName && zincGeometry.groupName.includes("Fibres")) {
					zincGeometry.setVisibility(flag);
				} else {
					zincGeometry.setVisibility(!flag);
				}
				zincGeometry.setMorphTime(currentTime);
			}
		}

		function glyphsetShowFibres(flag, currentTime) {
			return function(zincGlyphset) {
				zincGlyphset.setVisibility(flag);
				zincGlyphset.setMorphTime(currentTime);
			}
		}

		function idleTimerReached() {
			var openedPage = "";
			for (var i = 0; i < leftPanelGreenIDs.length; i++) {
				if (document.getElementById(leftPanelGreenIDs[i]).classList.contains("open")) {
					openedPage = leftPanelGreenIDs[i];
				}
			}
			zincRenderer.getCurrentScene().getZincCameraControls().stopAutoTumble();
			if (openedPage == "initialNormal"){
				heartElectricityClicked();
			} else if (openedPage == "leftHeartElectricity") {
				arrhythmiaClicked();
			} else if (openedPage == "leftHeartArrhythmia") {
				heartAttackClicked();
			} else if (openedPage == "leftHeartAttack") {
				heartAttackStagePressed("SmallInfarct", "MildHeartAttack", "leftModerateAttack");
			} else if (openedPage == "leftModerateAttack") {
				heartAttackStagePressed("LargeInfarct", "SevereHeartAttack", "leftSevereAttack");
			} else if (openedPage == "leftSevereAttack") {
				heartFailureClicked();
			} else if (openedPage == "leftHeartFailure") {
				heartFailureStagePressed("CompensatedFailure", "CompensatedFailure", "leftCompensatedFailure");
			} else if (openedPage == "leftCompensatedFailure") {
				heartFailureStagePressed("DecompensatedFailure", "DecompensatedFailure", "leftDecompensatedFailure");
			} else if (openedPage == "leftDecompensatedFailure") {
				homeClicked();
			}
			zincRenderer.getCurrentScene().resetView();
			zincRenderer.getCurrentScene().getZincCameraControls().autoTumble(
				[1.0, 0.0], 0.01, true);
			zincRenderer.getCurrentScene().getZincCameraControls().enableAutoTumble();
			idleTime = 0;
			oldTime = new Date();
		}

		function showVideo(videoName) {
			var videoURL = "videos/" + videoName;
			document.getElementById("heart_video").src=videoURL;
			videoDialog.show();
			require(["dijit/registry"], function(registry){
				registry.byId("dialogColor").show();
			});
		}

		function shareCameraSettings(oldCam) {
			if (oldCam) {
				var newCam = zincRenderer.getCurrentScene().camera;
				newCam.near = oldCam.near;
				newCam.far = oldCam.far;
				newCam.position.copy(oldCam.position);
				newCam.target = new THREE.Vector3( oldCam.target.x, oldCam.target.y, oldCam.target.z );
				newCam.up.copy(oldCam.up);
				zincRenderer.getCurrentScene().updateDirectionalLight();
			}
		}

		function pauseVideo() {
    		document.getElementById("heart_video").pause();
		}

		function showFibres(flag) {
			var currentScene = zincRenderer.getCurrentScene();
			var currentTime = zincRenderer.getCurrentTime();
			currentScene.forEachGeometry(geometryShowFibres(flag, currentTime));
			currentScene.forEachGlyphset(glyphsetShowFibres(flag, currentTime));
			if (flag) {
				document.getElementById("showFibres").classList.remove("open");
				document.getElementById("showFibres").classList.add("closed");
				document.getElementById("hideFibres").classList.remove("closed");
				document.getElementById("hideFibres").classList.add("open");
			} else {
				document.getElementById("showFibres").classList.remove("closed");
				document.getElementById("showFibres").classList.add("open");
				document.getElementById("hideFibres").classList.remove("open");
				document.getElementById("hideFibres").classList.add("closed");
				showHalf();
			}

			//currentScene.forEachGeometry(geometryShowHalf());
		}

		function geometryShowHalf() {
			return function(zincGeometry) {
				if (zincGeometry.groupName && zincGeometry.groupName.includes("Post")) {
					zincGeometry.setVisibility(!halfHeartFlag);
				}
			}
		}

		function showHalf() {
			var currentScene = zincRenderer.getCurrentScene();
			currentScene.forEachGeometry(geometryShowHalf());
		}

		function geometryIsShowingHalf() {
			return function(zincGeometry) {
				if (zincGeometry.groupName && zincGeometry.groupName.includes("Post")) {
					halfHeartFlag = zincGeometry.morph.visible ? false : true;
				}
			}
		}

		function isShowingHalf() {
			var currentScene = zincRenderer.getCurrentScene();
			currentScene.forEachGeometry(geometryIsShowingHalf());
		}

		var halfHeartPressed = function() {
			if (halfHeartFlag) {
				halfHeartFlag = false;
			} else {
				halfHeartFlag = true;
			}
			displayHalfHeartIcon();

			showHalf();
		}

		function setUpArrays() {
			ECGurls["Normal"] = "ECG/NormalECG.json";
			ECGurls["Diastolic"] = "ECG/DiastolicECG.json";
			ECGurls["Systolic"] = "ECG/SystolicECG.json";
			LVPurls["Normal"] = "LVP/NormalLVP.json";
			LVPurls["Diastolic"] = "LVP/DiastolicLVP.json";
			LVPurls["Systolic"] = "LVP/SystolicLVP.json";
			ECGurls["NoInfarct"] = "ECG/NormalECG.json";
			ECGurls["SmallInfarct"] = "ECG/MildInfarctECG.json";
			ECGurls["LargeInfarct"] = "ECG/LargeInfarctECG.json";
			LVPurls["NoInfarct"] = "LVP/NormalLVP.json";
			LVPurls["SmallInfarct"] = "LVP/smallInfarctLVP.json";
			LVPurls["LargeInfarct"] = "LVP/largeInfarctLVP.json";
			ECGurls["Arrhythmia"] = "ECG/ArrhythmiaECG.json";
			LVPurls["Arrhythmia"] = "LVP/ArrhythmiaLVP.json";
			ECGurls["NoFailure"] = "ECG/NormalECG.json";
			LVPurls["NoFailure"] = "LVP/NormalLVP.json";
			ECGurls["CompensatedFailure"] = "ECG/DiastolicECG.json";
			LVPurls["CompensatedFailure"] = "LVP/DiastolicLVP.json";
			ECGurls["DecompensatedFailure"] = "ECG/SystolicECG.json";
			LVPurls["DecompensatedFailure"] = "LVP/SystolicLVP.json";

			modelURLsArray["DeformingHeart"] = ["models/deforming_heart_metadata.json",
				"models/deforming_heart_view.json"];
			modelURLsArray["NormalElectricity"] = ["heartElectricity/normalActivity_metadata.json",
				"heartElectricity/normalActivity_view.json"];
			modelURLsArray["ArrythmiaElectricity"] = ["heartElectricity/arrythmiaActivity_metadata.json",
				"heartElectricity/arrythmiaActivity_view.json"];
			modelURLsArray["LargeInfarct"] = ["heartInfarct/largeInfarct_metadata.json",
				"heartInfarct/largeInfarct_view.json"];
			modelURLsArray["SmallInfarct"] = ["heartInfarct/smallInfarct_metadata.json",
				"heartInfarct/smallInfarct_view.json"];
			modelURLsArray["NoInfarct"] = ["heartInfarct/noInfarct_metadata.json",
				"heartInfarct/noInfarct_view.json"];
			modelURLsArray["NoFailure"] = ["heartInfarct/noInfarct_metadata.json",
				"heartInfarct/noInfarct_view.json"];
			modelURLsArray["CompensatedFailure"] = ["heartFailure/compensated_metadata.json", "heartFailure/compensated_view.json"];
			modelURLsArray["DecompensatedFailure"] = ["heartFailure/decompensated_metadata.json", "heartFailure/decompensated_view.json"];

			ECGTexts["Normal"] = "electrical pulses make the heart muscle contract";
			LVPTexts["Normal"] = "muscle contraction generates pump pressure";
			ECGTexts["Arrhythmia"] = "abnormal electricity";
			LVPTexts["Arrhythmia"] = "poor pump pressure";
			ECGTexts["NoInfarct"] = "electrical pulses make the heart muscle contract";
			LVPTexts["NoInfarct"] = "muscle contraction generates pump pressure";
			ECGTexts["SmallInfarct"] = "electrical pulses make the heart muscle contract";
			LVPTexts["SmallInfarct"] = "damaged muscle leads to less contraction force and less pressure generated";
			ECGTexts["LargeInfarct"] = "electrical pulses make the heart muscle contract";
			LVPTexts["LargeInfarct"] = "damaged muscle leads to less contraction force and less pressure generated";
			ECGTexts["NoFailure"] = "electrical pulses make the heart muscle contract";
			LVPTexts["NoFailure"] = "muscle contraction generates pump pressure";
			ECGTexts["CompensatedFailure"] = "electrical pulses make the heart muscle contract";
			LVPTexts["CompensatedFailure"] = "muscle contraction generates pump pressure";
			ECGTexts["DecompensatedFailure"] = "electrical pulses make the heart muscle contract";
			LVPTexts["DecompensatedFailure"] = "thin-walled hearts struggle to maintain pump pressure";
		}

		function resetAllModelsView() {
			for (var k in modelToSceneArray) {
        		if (modelToSceneArray.hasOwnProperty(k)) {
           			modelToSceneArray[k].resetView();
        		}
    		}
		}

		function meshReady(oldCam) {
			return function(mygeometry) {
				if (mygeometry.groupName && mygeometry.groupName.includes("Post")) {
					mygeometry.setVisibility(!halfHeartFlag);
				}
				if (mygeometry.groupName && mygeometry.groupName.includes("Fibres")) {
					mygeometry.setVisibility(false);
				}
				shareCameraSettings(oldCam);
				zincRenderer.getCurrentScene().getZincCameraControls().updateAutoTumble();
			}
		}

		function loadModel(model_name, rateScaling) {
			metaURL = modelURLsArray[model_name][0];
			viewURL = modelURLsArray[model_name][1];
			var scene = zincRenderer.getSceneByName(model_name);
			if (scene == undefined) {
				scene = zincRenderer.createScene(model_name);
				scene.setDuration(scene.getDuration() / rateScaling);
				scene.loadViewURL(viewURL);
				scene.loadMetadataURL(metaURL, meshReady(previousCamera));
				// Same label position seems to work with all models but ArrythmiaElectricity
				// arguments are as followed scene, label, x, y, z and scaling
				if (model_name == "ArrythmiaElectricity") {
					addLabelToScene(scene, "RV", 0.0, 38.639515,50.421283, 15.0);
					addLabelToScene(scene, "LV", 0.0,-38.639515,50.421283, 15.0);				
				} else {
					addLabelToScene(scene, "RV", -30.056679,88.639515,-0.421283, 30.0);
					addLabelToScene(scene, "LV", -60.056679,-28.639515,-0.421283, 30.0);
				}
				zincRenderer.setCurrentScene(scene);
				modelToSceneArray[model_name] = scene;
			} else {
				zincRenderer.setCurrentScene(scene);
				shareCameraSettings(previousCamera);
				showHalf();
			}
		}

		function resetView()	{
			zincRenderer.viewAll()
		}

		function updateSlider(newValue)	{
			zincRenderer.setPlayRate(newValue);
		}

	</script>

	</body>
</html>
